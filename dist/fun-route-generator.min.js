/*! For license information please see fun-route-generator.min.js.LICENSE.txt */
!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.FunRouteGenerator=e():t.FunRouteGenerator=e()}(this,()=>{return t={594:t=>{function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},e(t)}function r(t){return function(t){if(Array.isArray(t))return n(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return n(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?n(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,p(n.key),n)}}function i(){var t,e,r="function"==typeof Symbol?Symbol:{},n=r.iterator||"@@iterator",o=r.toStringTag||"@@toStringTag";function s(r,n,o,i){var s=n&&n.prototype instanceof u?n:u,p=Object.create(s.prototype);return a(p,"_invoke",function(r,n,o){var i,a,s,u=0,p=o||[],f=!1,l={p:0,n:0,v:t,a:h,f:h.bind(t,4),d:function(e,r){return i=e,a=0,s=t,l.n=r,c}};function h(r,n){for(a=r,s=n,e=0;!f&&u&&!o&&e<p.length;e++){var o,i=p[e],h=l.p,y=i[2];r>3?(o=y===n)&&(s=i[(a=i[4])?5:(a=3,3)],i[4]=i[5]=t):i[0]<=h&&((o=r<2&&h<i[1])?(a=0,l.v=n,l.n=i[1]):h<y&&(o=r<3||i[0]>n||n>y)&&(i[4]=r,i[5]=n,l.n=y,a=0))}if(o||r>1)return c;throw f=!0,n}return function(o,p,y){if(u>1)throw TypeError("Generator is already running");for(f&&1===p&&h(p,y),a=p,s=y;(e=a<2?t:s)||!f;){i||(a?a<3?(a>1&&(l.n=-1),h(a,s)):l.n=s:l.v=s);try{if(u=2,i){if(a||(o="next"),e=i[o]){if(!(e=e.call(i,s)))throw TypeError("iterator result is not an object");if(!e.done)return e;s=e.value,a<2&&(a=0)}else 1===a&&(e=i.return)&&e.call(i),a<2&&(s=TypeError("The iterator does not provide a '"+o+"' method"),a=1);i=t}else if((e=(f=l.n<0)?s:r.call(n,l))!==c)break}catch(e){i=t,a=1,s=e}finally{u=1}}return{value:e,done:f}}}(r,o,i),!0),p}var c={};function u(){}function p(){}function f(){}e=Object.getPrototypeOf;var l=[][n]?e(e([][n]())):(a(e={},n,function(){return this}),e),h=f.prototype=u.prototype=Object.create(l);function y(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,f):(t.__proto__=f,a(t,o,"GeneratorFunction")),t.prototype=Object.create(h),t}return p.prototype=f,a(h,"constructor",f),a(f,"constructor",p),p.displayName="GeneratorFunction",a(f,o,"GeneratorFunction"),a(h),a(h,o,"Generator"),a(h,n,function(){return this}),a(h,"toString",function(){return"[object Generator]"}),(i=function(){return{w:s,m:y}})()}function a(t,e,r,n){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}a=function(t,e,r,n){function i(e,r){a(t,e,function(t){return this._invoke(e,r,t)})}e?o?o(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n}):t[e]=r:(i("next",0),i("throw",1),i("return",2))},a(t,e,r,n)}function s(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)}return r}function c(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?s(Object(r),!0).forEach(function(e){u(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}function u(t,e,r){return(e=p(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function p(t){var r=function(t){if("object"!=e(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!=e(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==e(r)?r:r+""}function f(t,e,r,n,o,i,a){try{var s=t[i](a),c=s.value}catch(t){return void r(t)}s.done?e(c):Promise.resolve(c).then(n,o)}function l(t){return function(){var e=this,r=arguments;return new Promise(function(n,o){var i=t.apply(e,r);function a(t){f(i,n,o,a,s,"next",t)}function s(t){f(i,n,o,a,s,"throw",t)}a(void 0)})}}var h=function(t,e){var r=arguments;return l(i().m(function n(){var o,a,s,u,p,f,l;return i().w(function(n){for(;;)switch(n.n){case 0:return o=r.length>2&&void 0!==r[2]?r[2]:{},n.n=1,fetch(t,{method:"POST",headers:c({"Content-Type":"application/json"},o.headers),body:JSON.stringify(e)});case 1:if((a=n.v).ok){n.n=3;break}return s=new Error("HTTP ".concat(a.status)),u=a.status,p=a.statusText,n.n=2,a.json().catch(function(){return{message:a.statusText}});case 2:throw f=n.v,s.response={status:u,statusText:p,data:f},s;case 3:return n.n=4,a.json();case 4:return l=n.v,n.a(2,{data:l})}},n)}))()},y=function(){return t=function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.config=c({apiKey:e.apiKey||"",host:e.host||"https://graphhopper.com/api/1",timeout:e.timeout||15e3,profile:e.profile||"car",locale:e.locale||"en",instructions:!1!==e.instructions,points_encoded:!1!==e.points_encoded,elevation:e.elevation||!1,distance_range:[5e4,5e5],curve_level:"medium",route_type:"roundtrip"},e),!this.config.apiKey)throw new Error("GraphHopper API key is required");this.curveSettings={low:{avoid_highways:!1,prefer_scenic:!1,detour_factor:1.1},medium:{avoid_highways:!0,prefer_scenic:!0,detour_factor:1.3},high:{avoid_highways:!0,prefer_scenic:!0,detour_factor:1.6}}},e=[{key:"generateFunRoute",value:(y=l(i().m(function t(e){var r;return i().w(function(t){for(;;)switch(t.n){case 0:if((r=c({profile:this.config.profile,locale:this.config.locale,points_encoded:this.config.points_encoded,instructions:this.config.instructions,elevation:this.config.elevation,curve_level:this.config.curve_level,route_type:this.config.route_type},e)).start_point&&Array.isArray(r.start_point)){t.n=1;break}throw new Error("起始点参数无效");case 1:if("point_to_point"!==r.route_type||r.end_point&&Array.isArray(r.end_point)){t.n=2;break}throw new Error("点对点路线需要提供终点");case 2:if(!(r.target_distance<5e4||r.target_distance>5e5)){t.n=3;break}throw new Error("目标距离必须在50-500km之间");case 3:if("roundtrip"!==r.route_type){t.n=4;break}return t.a(2,this._generateRoundTrip(r));case 4:return t.a(2,this._generatePointToPoint(r));case 5:return t.a(2)}},t,this)})),function(t){return y.apply(this,arguments)})},{key:"generateRoundTrip",value:(f=l(i().m(function t(e){var r,n,o,a,s,c;return i().w(function(t){for(;;)switch(t.n){case 0:if(r=e.startPoint,n=e.distance,o=e.curveLevel,a=void 0===o?"medium":o,s=e.startBearing,c=void 0===s?0:s,r&&Array.isArray(r)&&2===r.length){t.n=1;break}throw new Error("startPoint must be an array of [lat, lng]");case 1:if(!(!n||n<50||n>500)){t.n=2;break}throw new Error("distance must be between 50 and 500 km");case 2:return t.a(2,this.generateFunRoute({start_point:[r[1],r[0]],target_distance:1e3*n,curve_level:a,route_type:"roundtrip",start_bearing:c}))}},t,this)})),function(t){return f.apply(this,arguments)})},{key:"generatePointToPoint",value:(p=l(i().m(function t(e){var n,o,a,s,c,u,p;return i().w(function(t){for(;;)switch(t.n){case 0:if(n=e.startPoint,o=e.endPoint,a=e.curveLevel,s=void 0===a?"medium":a,c=e.targetDistance,n&&Array.isArray(n)&&2===n.length){t.n=1;break}throw new Error("startPoint must be an array of [lat, lng]");case 1:if(o&&Array.isArray(o)&&2===o.length){t.n=2;break}throw new Error("endPoint must be an array of [lat, lng]");case 2:if(u=[n,o],!c){t.n=4;break}if(!(c<50||c>500)){t.n=3;break}throw new Error("targetDistance must be between 50 and 500 km");case 3:p=this._generateDetourPoints(n,o,1e3*c,s),u=[n].concat(r(p),[o]);case 4:return t.a(2,this._requestRoute(u,s))}},t,this)})),function(t){return p.apply(this,arguments)})},{key:"_generateRoundTrip",value:(u=l(i().m(function t(e){var n,o,a,s,c,u,p,f;return i().w(function(t){for(;;)switch(t.n){case 0:return n=e.start_point,o=e.target_distance,a=e.curve_level||"medium",s=e.start_bearing||0,c=this._generateIntermediatePoints(n,o,a,s),u=[n].concat(r(c),[n]),p={points:u,profile:e.profile,instructions:e.instructions,points_encoded:e.points_encoded,elevation:e.elevation,locale:e.locale},this._applyCurveSettings(p,a),t.n=1,this._doRouteRequest(p);case 1:return(f=t.v).route_info={type:"roundtrip",target_distance:o,actual_distance:f.paths[0].distance,curve_level:a,start_bearing:s},t.a(2,f)}},t,this)})),function(t){return u.apply(this,arguments)})},{key:"_generatePointToPoint",value:(s=l(i().m(function t(e){var n,o,a,s,c,u,p,f,l;return i().w(function(t){for(;;)switch(t.n){case 0:if(n=e.start_point,o=e.end_point,a=e.target_distance,s=e.curve_level||"medium",!((c=this._calculateDistance(n,o))>a)){t.n=1;break}throw new Error("起终点直线距离超过目标距离");case 1:return u=this._generateDetourPoints(n,o,a,s),p=[n].concat(r(u),[o]),f={points:p,profile:e.profile,instructions:e.instructions,points_encoded:e.points_encoded,elevation:e.elevation,locale:e.locale},this._applyCurveSettings(f,s),t.n=2,this._doRouteRequest(f);case 2:return(l=t.v).route_info={type:"point_to_point",target_distance:a,actual_distance:l.paths[0].distance,direct_distance:c,curve_level:s},t.a(2,l)}},t,this)})),function(t){return s.apply(this,arguments)})},{key:"_generateIntermediatePoints",value:function(t,e,r,n){for(var o=[],i="high"===r?3:"medium"===r?2:1,a=e/1e3/(2*Math.PI),s=0;s<i;s++){var c=n+360/i*(s+1),u=this._calculatePointAtDistance(t,1e3*a,c),p=.01*(Math.random()-.5);u[0]+=p,u[1]+=p,o.push(u)}return o}},{key:"_generateDetourPoints",value:function(t,e,r,n){var o=[],i=r-this._calculateDistance(t,e);if(i<=0)return o;for(var a="high"===n?2:1,s=0;s<a;s++){var c=(s+1)/(a+1),u=[t[0]+(e[0]-t[0])*c,t[1]+(e[1]-t[1])*c],p=this._calculateBearing(t,e)+90+60*(Math.random()-.5),f=i/a*.3,l=this._calculatePointAtDistance(u,f,p);o.push(l)}return o}},{key:"_doRouteRequest",value:(a=l(i().m(function t(e){var r,n,o,a,s,c;return i().w(function(t){for(;;)switch(t.p=t.n){case 0:return r="".concat(this.config.host,"/route?key=").concat(this.config.apiKey),t.p=1,t.n=2,h(r,e,{headers:{"Content-Type":"application/json"}});case 2:if(n=t.v,(o=n.data).paths)for(a=0;a<o.paths.length;a++)(s=o.paths[a]).points_encoded&&"string"==typeof s.points&&(s.points={type:"LineString",coordinates:this._decodePolyline(s.points)}),s.snapped_waypoints&&"string"==typeof s.snapped_waypoints&&(s.snapped_waypoints={type:"LineString",coordinates:this._decodePolyline(s.snapped_waypoints)});return t.a(2,o);case 3:if(t.p=3,!(c=t.v).response){t.n=4;break}throw new Error("GraphHopper API Error: ".concat(c.response.status," - ").concat(c.response.data.message||c.response.statusText));case 4:if(!c.request){t.n=5;break}throw new Error("Network Error: Unable to reach GraphHopper API");case 5:throw new Error("Request Error: ".concat(c.message));case 6:return t.a(2)}},t,this,[[1,3]])})),function(t){return a.apply(this,arguments)})},{key:"_requestRoute",value:(n=l(i().m(function t(e,r){var n,o;return i().w(function(t){for(;;)if(0===t.n)return n=e.map(function(t){return[t[1],t[0]]}),o={points:n,profile:this.config.profile,instructions:!0,points_encoded:!0,elevation:!1,locale:this.config.locale},this._applyCurveSettings(o,r),t.a(2,this._doRouteRequest(o))},t,this)})),function(t,e){return n.apply(this,arguments)})},{key:"_decodePolyline",value:function(t){for(var e=[],r=0,n=0,o=0;r<t.length;){var i=void 0,a=0,s=0;do{s|=(31&(i=t.charCodeAt(r++)-63))<<a,a+=5}while(i>=32);n+=1&s?~(s>>1):s>>1,a=0,s=0;do{s|=(31&(i=t.charCodeAt(r++)-63))<<a,a+=5}while(i>=32);o+=1&s?~(s>>1):s>>1,e.push([o/1e5,n/1e5])}return e}},{key:"_applyCurveSettings",value:function(t,e){var r=this.curveSettings[e]||this.curveSettings.medium;return r.avoid_highways&&(t.avoid="motorway"),r.prefer_scenic?t.weighting="shortest":t.weighting="fastest",t}},{key:"_calculateDistance",value:function(t,e){var r=t[1]*Math.PI/180,n=e[1]*Math.PI/180,o=(e[1]-t[1])*Math.PI/180,i=(e[0]-t[0])*Math.PI/180,a=Math.sin(o/2)*Math.sin(o/2)+Math.cos(r)*Math.cos(n)*Math.sin(i/2)*Math.sin(i/2);return 2*Math.atan2(Math.sqrt(a),Math.sqrt(1-a))*6371e3}},{key:"_calculateBearing",value:function(t,e){var r=t[1]*Math.PI/180,n=e[1]*Math.PI/180,o=(e[0]-t[0])*Math.PI/180,i=Math.sin(o)*Math.cos(n),a=Math.cos(r)*Math.sin(n)-Math.sin(r)*Math.cos(n)*Math.cos(o);return(180*Math.atan2(i,a)/Math.PI+360)%360}},{key:"_calculatePointAtDistance",value:function(t,e,r){var n=6371e3,o=t[1]*Math.PI/180,i=t[0]*Math.PI/180,a=r*Math.PI/180,s=Math.asin(Math.sin(o)*Math.cos(e/n)+Math.cos(o)*Math.sin(e/n)*Math.cos(a));return[180*(i+Math.atan2(Math.sin(a)*Math.sin(e/n)*Math.cos(o),Math.cos(e/n)-Math.sin(o)*Math.sin(s)))/Math.PI,180*s/Math.PI]}}],e&&o(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n,a,s,u,p,f,y}();t.exports?t.exports=y:"undefined"!=typeof window&&(window.FunRouteGenerator=y)}},e={},function r(n){var o=e[n];if(void 0!==o)return o.exports;var i=e[n]={exports:{}};return t[n](i,i.exports,r),i.exports}(594);var t,e});
//# sourceMappingURL=fun-route-generator.min.js.map